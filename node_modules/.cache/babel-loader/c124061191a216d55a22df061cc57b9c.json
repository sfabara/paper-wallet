{"ast":null,"code":"'use strict';\n\nvar bn = require('bn.js');\n\nvar elliptic = require('../../elliptic');\n\nvar utils = elliptic.utils;\nvar assert = utils.assert;\n\nfunction Signature(options, enc) {\n  if (options instanceof Signature) return options;\n  if (this._importDER(options, enc)) return;\n  assert(options.r && options.s, 'Signature without r or s');\n  this.r = new bn(options.r, 16);\n  this.s = new bn(options.s, 16);\n}\n\nmodule.exports = Signature;\n\nSignature.prototype._importDER = function _importDER(data, enc) {\n  data = utils.toArray(data, enc);\n  if (data.length < 6 || data[0] !== 0x30 || data[2] !== 0x02) return false;\n  var total = data[1];\n  if (1 + total > data.length) return false;\n  var rlen = data[3]; // Short length notation\n\n  if (rlen >= 0x80) return false;\n  if (4 + rlen + 2 >= data.length) return false;\n  if (data[4 + rlen] !== 0x02) return false;\n  var slen = data[5 + rlen]; // Short length notation\n\n  if (slen >= 0x80) return false;\n  if (4 + rlen + 2 + slen > data.length) return false;\n  this.r = new bn(data.slice(4, 4 + rlen));\n  this.s = new bn(data.slice(4 + rlen + 2, 4 + rlen + 2 + slen));\n  return true;\n};\n\nSignature.prototype.toDER = function toDER(enc) {\n  var r = this.r.toArray();\n  var s = this.s.toArray(); // Pad values\n\n  if (r[0] & 0x80) r = [0].concat(r); // Pad values\n\n  if (s[0] & 0x80) s = [0].concat(s);\n  var total = r.length + s.length + 4;\n  var res = [0x30, total, 0x02, r.length];\n  res = res.concat(r, [0x02, s.length], s);\n  return utils.encode(res, enc);\n};","map":{"version":3,"sources":["/home/user/Desktop/paper/node_modules/bitcore-lib-litecoin/node_modules/elliptic/lib/elliptic/ec/signature.js"],"names":["bn","require","elliptic","utils","assert","Signature","options","enc","_importDER","r","s","module","exports","prototype","data","toArray","length","total","rlen","slen","slice","toDER","concat","res","encode"],"mappings":"AAAA;;AAEA,IAAIA,EAAE,GAAGC,OAAO,CAAC,OAAD,CAAhB;;AAEA,IAAIC,QAAQ,GAAGD,OAAO,CAAC,gBAAD,CAAtB;;AACA,IAAIE,KAAK,GAAGD,QAAQ,CAACC,KAArB;AACA,IAAIC,MAAM,GAAGD,KAAK,CAACC,MAAnB;;AAEA,SAASC,SAAT,CAAmBC,OAAnB,EAA4BC,GAA5B,EAAiC;AAC/B,MAAID,OAAO,YAAYD,SAAvB,EACE,OAAOC,OAAP;AAEF,MAAI,KAAKE,UAAL,CAAgBF,OAAhB,EAAyBC,GAAzB,CAAJ,EACE;AAEFH,EAAAA,MAAM,CAACE,OAAO,CAACG,CAAR,IAAaH,OAAO,CAACI,CAAtB,EAAyB,0BAAzB,CAAN;AACA,OAAKD,CAAL,GAAS,IAAIT,EAAJ,CAAOM,OAAO,CAACG,CAAf,EAAkB,EAAlB,CAAT;AACA,OAAKC,CAAL,GAAS,IAAIV,EAAJ,CAAOM,OAAO,CAACI,CAAf,EAAkB,EAAlB,CAAT;AACD;;AACDC,MAAM,CAACC,OAAP,GAAiBP,SAAjB;;AAEAA,SAAS,CAACQ,SAAV,CAAoBL,UAApB,GAAiC,SAASA,UAAT,CAAoBM,IAApB,EAA0BP,GAA1B,EAA+B;AAC9DO,EAAAA,IAAI,GAAGX,KAAK,CAACY,OAAN,CAAcD,IAAd,EAAoBP,GAApB,CAAP;AACA,MAAIO,IAAI,CAACE,MAAL,GAAc,CAAd,IAAmBF,IAAI,CAAC,CAAD,CAAJ,KAAY,IAA/B,IAAuCA,IAAI,CAAC,CAAD,CAAJ,KAAY,IAAvD,EACE,OAAO,KAAP;AACF,MAAIG,KAAK,GAAGH,IAAI,CAAC,CAAD,CAAhB;AACA,MAAI,IAAIG,KAAJ,GAAYH,IAAI,CAACE,MAArB,EACE,OAAO,KAAP;AACF,MAAIE,IAAI,GAAGJ,IAAI,CAAC,CAAD,CAAf,CAP8D,CAQ9D;;AACA,MAAII,IAAI,IAAI,IAAZ,EACE,OAAO,KAAP;AACF,MAAI,IAAIA,IAAJ,GAAW,CAAX,IAAgBJ,IAAI,CAACE,MAAzB,EACE,OAAO,KAAP;AACF,MAAIF,IAAI,CAAC,IAAII,IAAL,CAAJ,KAAmB,IAAvB,EACE,OAAO,KAAP;AACF,MAAIC,IAAI,GAAGL,IAAI,CAAC,IAAII,IAAL,CAAf,CAf8D,CAgB9D;;AACA,MAAIC,IAAI,IAAI,IAAZ,EACE,OAAO,KAAP;AACF,MAAI,IAAID,IAAJ,GAAW,CAAX,GAAeC,IAAf,GAAsBL,IAAI,CAACE,MAA/B,EACE,OAAO,KAAP;AAEF,OAAKP,CAAL,GAAS,IAAIT,EAAJ,CAAOc,IAAI,CAACM,KAAL,CAAW,CAAX,EAAc,IAAIF,IAAlB,CAAP,CAAT;AACA,OAAKR,CAAL,GAAS,IAAIV,EAAJ,CAAOc,IAAI,CAACM,KAAL,CAAW,IAAIF,IAAJ,GAAW,CAAtB,EAAyB,IAAIA,IAAJ,GAAW,CAAX,GAAeC,IAAxC,CAAP,CAAT;AAEA,SAAO,IAAP;AACD,CA1BD;;AA4BAd,SAAS,CAACQ,SAAV,CAAoBQ,KAApB,GAA4B,SAASA,KAAT,CAAed,GAAf,EAAoB;AAC9C,MAAIE,CAAC,GAAG,KAAKA,CAAL,CAAOM,OAAP,EAAR;AACA,MAAIL,CAAC,GAAG,KAAKA,CAAL,CAAOK,OAAP,EAAR,CAF8C,CAI9C;;AACA,MAAIN,CAAC,CAAC,CAAD,CAAD,GAAO,IAAX,EACEA,CAAC,GAAG,CAAE,CAAF,EAAMa,MAAN,CAAab,CAAb,CAAJ,CAN4C,CAO9C;;AACA,MAAIC,CAAC,CAAC,CAAD,CAAD,GAAO,IAAX,EACEA,CAAC,GAAG,CAAE,CAAF,EAAMY,MAAN,CAAaZ,CAAb,CAAJ;AAEF,MAAIO,KAAK,GAAGR,CAAC,CAACO,MAAF,GAAWN,CAAC,CAACM,MAAb,GAAsB,CAAlC;AACA,MAAIO,GAAG,GAAG,CAAE,IAAF,EAAQN,KAAR,EAAe,IAAf,EAAqBR,CAAC,CAACO,MAAvB,CAAV;AACAO,EAAAA,GAAG,GAAGA,GAAG,CAACD,MAAJ,CAAWb,CAAX,EAAc,CAAE,IAAF,EAAQC,CAAC,CAACM,MAAV,CAAd,EAAkCN,CAAlC,CAAN;AACA,SAAOP,KAAK,CAACqB,MAAN,CAAaD,GAAb,EAAkBhB,GAAlB,CAAP;AACD,CAfD","sourcesContent":["'use strict';\n\nvar bn = require('bn.js');\n\nvar elliptic = require('../../elliptic');\nvar utils = elliptic.utils;\nvar assert = utils.assert;\n\nfunction Signature(options, enc) {\n  if (options instanceof Signature)\n    return options;\n\n  if (this._importDER(options, enc))\n    return;\n\n  assert(options.r && options.s, 'Signature without r or s');\n  this.r = new bn(options.r, 16);\n  this.s = new bn(options.s, 16);\n}\nmodule.exports = Signature;\n\nSignature.prototype._importDER = function _importDER(data, enc) {\n  data = utils.toArray(data, enc);\n  if (data.length < 6 || data[0] !== 0x30 || data[2] !== 0x02)\n    return false;\n  var total = data[1];\n  if (1 + total > data.length)\n    return false;\n  var rlen = data[3];\n  // Short length notation\n  if (rlen >= 0x80)\n    return false;\n  if (4 + rlen + 2 >= data.length)\n    return false;\n  if (data[4 + rlen] !== 0x02)\n    return false;\n  var slen = data[5 + rlen];\n  // Short length notation\n  if (slen >= 0x80)\n    return false;\n  if (4 + rlen + 2 + slen > data.length)\n    return false;\n\n  this.r = new bn(data.slice(4, 4 + rlen));\n  this.s = new bn(data.slice(4 + rlen + 2, 4 + rlen + 2 + slen));\n\n  return true;\n};\n\nSignature.prototype.toDER = function toDER(enc) {\n  var r = this.r.toArray();\n  var s = this.s.toArray();\n\n  // Pad values\n  if (r[0] & 0x80)\n    r = [ 0 ].concat(r);\n  // Pad values\n  if (s[0] & 0x80)\n    s = [ 0 ].concat(s);\n\n  var total = r.length + s.length + 4;\n  var res = [ 0x30, total, 0x02, r.length ];\n  res = res.concat(r, [ 0x02, s.length ], s);\n  return utils.encode(res, enc);\n};\n"]},"metadata":{},"sourceType":"script"}